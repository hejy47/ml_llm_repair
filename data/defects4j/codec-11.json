{"org.apache.commons.codec.net.QuotedPrintableCodec.encodeQuotedPrintable": {"buggy_content": "private static final void encodeQuotedPrintable(int b, ByteArrayOutputStream buffer) {\n    buffer.write(ESCAPE_CHAR);\n    char hex1 = Character.toUpperCase(Character.forDigit((b >> 4) & 0xF, 16));\n    char hex2 = Character.toUpperCase(Character.forDigit(b & 0xF, 16));\n    buffer.write(hex1);\n    buffer.write(hex2);\n}", "method_range": "114-120", "fault_locations": "114,118,119"}, "org.apache.commons.codec.net.QuotedPrintableCodec.encodeQuotedPrintable1": {"buggy_content": "public static final byte[] encodeQuotedPrintable(BitSet printable, byte[] bytes) {\n    if (bytes == null) {\n        return null;\n    }\n    if (printable == null) {\n        printable = PRINTABLE_CHARS;\n    }\n    ByteArrayOutputStream buffer = new ByteArrayOutputStream();\n    // encode up to buffer.length - 3, the last three octets will be treated\n    // separately for simplification of note #3\n    // up to this length it is safe to add any byte, encoded or not\n    for (byte c : bytes) {\n        int b = c;\n        if (b < 0) {\n            b = 256 + b;\n        }\n        if (printable.get(b)) {\n            buffer.write(b);\n        } else {\n            // rule #3: whitespace at the end of a line *must* be encoded\n            // rule #5: soft line break\n            encodeQuotedPrintable(b, buffer);\n        }\n    }\n    // rule #3: whitespace at the end of a line *must* be encoded\n    // if we would do a soft break line after this octet, encode whitespace\n    // note #3: '=' *must not* be the ultimate or penultimate character\n    // simplification: if < 6 bytes left, do a soft line break as we may need\n    //                 exactly 6 bytes space for the last 2 bytes\n    // rule #3: trailing whitespace shall be encoded\n    return buffer.toByteArray();\n}", "method_range": "167-202", "fault_locations": "173,174,175,176,177,178,179,180,181,182,183,184,185,186,189,190,191"}, "org.apache.commons.codec.net.QuotedPrintableCodec.decodeQuotedPrintable": {"buggy_content": "public static final byte[] decodeQuotedPrintable(byte[] bytes) throws DecoderException {\n    if (bytes == null) {\n        return null;\n    }\n    ByteArrayOutputStream buffer = new ByteArrayOutputStream();\n    for (int i = 0; i < bytes.length; i++) {\n        final int b = bytes[i];\n        if (b == ESCAPE_CHAR) {\n            try {\n                // if the next octet is a CR we have found a soft line break\n                int u = Utils.digit16(bytes[++i]);\n                int l = Utils.digit16(bytes[++i]);\n                buffer.write((char) ((u << 4) + l));\n            } catch (ArrayIndexOutOfBoundsException e) {\n                throw new DecoderException(\"Invalid quoted-printable encoding\", e);\n            }\n        } else {\n            // every other octet is appended except for CR & LF\n            buffer.write(b);\n        }\n    }\n    return buffer.toByteArray();\n}", "method_range": "219-241", "fault_locations": "219,220,224,225,229,235"}}