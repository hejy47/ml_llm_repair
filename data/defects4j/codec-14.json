{"org.apache.commons.codec.language.bm.PhoneticEngine.applyFinalRules": {"buggy_content": "private PhonemeBuilder applyFinalRules(final PhonemeBuilder phonemeBuilder, final Map<String, List<Rule>> finalRules) {\n    if (finalRules == null) {\n        throw new NullPointerException(\"finalRules can not be null\");\n    }\n    if (finalRules.isEmpty()) {\n        return phonemeBuilder;\n    }\n    final Set<Rule.Phoneme> phonemes = new TreeSet<Rule.Phoneme>(Rule.Phoneme.COMPARATOR);\n    for (final Rule.Phoneme phoneme : phonemeBuilder.getPhonemes()) {\n        PhonemeBuilder subBuilder = PhonemeBuilder.empty(phoneme.getLanguages());\n        final String phonemeText = phoneme.getPhonemeText().toString();\n        for (int i = 0; i < phonemeText.length(); ) {\n            final RulesApplication rulesApplication = new RulesApplication(finalRules, phonemeText, subBuilder, i, maxPhonemes).invoke();\n            final boolean found = rulesApplication.isFound();\n            subBuilder = rulesApplication.getPhonemeBuilder();\n            if (!found) {\n                // not found, appending as-is\n                subBuilder.append(phonemeText.subSequence(i, i + 1));\n            }\n            i = rulesApplication.getI();\n        }\n        // the phonemes map orders the phonemes only based on their text, but ignores the language set\n        // when adding new phonemes, check for equal phonemes and merge their language set, otherwise\n        // phonemes with the same text but different language set get lost\n        phonemes.addAll(subBuilder.getPhonemes());\n    }\n    return new PhonemeBuilder(phonemes);\n}", "method_range": "329-365", "fault_locations": "336,337,338,358,359,361,364"}}