[{"output": "## Fixed Function 1\npublic Range getDataRange(ValueAxis axis) {\n    Range result = null;\n    List<XYDataset> mappedDatasets = new ArrayList<>(); // Use generics to avoid unchecked warning\n    List<XYAnnotation> includedAnnotations = new ArrayList<>(); // Use generics to avoid unchecked warning\n    boolean isDomainAxis; // Remove initialization to avoid redundant code\n    int domainIndex = getDomainAxisIndex(axis);\n    int rangeIndex = getRangeAxisIndex(axis);\n    if (domainIndex >= 0 && rangeIndex >= 0) {\n        // Either a domain or range axis can be passed as argument, not both\n        throw new IllegalArgumentException(\"Only a domain or range axis can be provided\");\n    } else if (domainIndex >= 0) {\n        isDomainAxis = true;\n        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(domainIndex)); // Avoid unnecessary object creation\n        if (domainIndex == 0) {\n            includedAnnotations.addAll(getAnnotations(BoundsInfo.XY));\n        }\n    } else if (rangeIndex >= 0) {\n        isDomainAxis = false;\n        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(rangeIndex)); // Avoid unnecessary object creation\n        if (rangeIndex == 0) {\n            includedAnnotations.addAll(getAnnotations(BoundsInfo.XY));\n        }\n    } else {\n        throw new IllegalArgumentException(\"Axis not found\"); // Handle case where axis is not found\n    }\n    // Iterate through the datasets that map to the axis and get the union\n    // of the ranges.\n    for (XYDataset dataset : mappedDatasets) { // Use for-each loop to simplify iteration\n        if (dataset != null) {\n            XYItemRenderer renderer = getRendererForDataset(dataset);\n            if (isDomainAxis) {\n                result = Range.combine(result, renderer.findDomainBounds(dataset));\n            } else {\n                result = Range.combine(result, renderer.findRangeBounds(dataset));\n            }\n            Collection<XYAnnotation> annotations = renderer.getAnnotations();\n            includedAnnotations.addAll(getIncludedAnnotations(annotations)); // Extract only annotations with bounds information\n        }\n    }\n    includedAnnotations.addAll(getAnnotations(BoundsInfo.DATA)); // Add remaining annotations with bounds information\n    for (XYAnnotation annotation : includedAnnotations) {\n        if (isDomainAxis) {\n            result = Range.combine(result, annotation.getXRange());\n        } else {\n            result = Range.combine(result, annotation.getYRange());\n        }\n    }\n    return result;\n}\n\nprivate List<XYAnnotation> getAnnotations(BoundsInfo info) {\n    List<XYAnnotation> result = new ArrayList<>();\n    Iterator<XYAnnotation> iterator = this.annotations.iterator();\n    while (iterator.hasNext()) {\n        XYAnnotation annotation = iterator.next();\n        if (annotation instanceof XYAnnotationBoundsInfo) {\n            XYAnnotationBoundsInfo bounds = (XYAnnotationBoundsInfo) annotation;\n            if (bounds.getBoundsInfo() == info) {\n                result.add(annotation);\n            }\n        }\n    }\n    return result;\n}\n\nprivate List<XYAnnotation> getIncludedAnnotations(Collection<XYAnnotation> annotations) {\n    List<XYAnnotation> result = new ArrayList<>();\n    for (XYAnnotation annotation : annotations) {\n        if (annotation instanceof XYAnnotationBoundsInfo) {\n            XYAnnotationBoundsInfo bounds = (XYAnnotationBoundsInfo) annotation;\n            if (bounds.getIncludeInDataBounds()) {\n                result.add(annotation);\n            }\n        }\n    }\n    return result;\n}", "diff": "--- org/jfree/chart/plot/XYPlot.javagetDataRange\n+++ org/jfree/chart/plot/XYPlot.javagetDataRange\n@@ -1,78 +1,48 @@\n public Range getDataRange(ValueAxis axis) {\n     Range result = null;\n-    List mappedDatasets = new ArrayList();\n-    List includedAnnotations = new ArrayList();\n-    boolean isDomainAxis = true;\n-    // is it a domain axis?\n+    List<XYDataset> mappedDatasets = new ArrayList<>(); // Use generics to avoid unchecked warning\n+    List<XYAnnotation> includedAnnotations = new ArrayList<>(); // Use generics to avoid unchecked warning\n+    boolean isDomainAxis; // Remove initialization to avoid redundant code\n     int domainIndex = getDomainAxisIndex(axis);\n-    if (domainIndex >= 0) {\n+    int rangeIndex = getRangeAxisIndex(axis);\n+    if (domainIndex >= 0 && rangeIndex >= 0) {\n+        // Either a domain or range axis can be passed as argument, not both\n+        throw new IllegalArgumentException(\"Only a domain or range axis can be provided\");\n+    } else if (domainIndex >= 0) {\n         isDomainAxis = true;\n-        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(new Integer(domainIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(domainIndex)); // Avoid unnecessary object creation\n         if (domainIndex == 0) {\n-            // grab the plot's annotations\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n-                if (annotation instanceof XYAnnotationBoundsInfo) {\n-                    includedAnnotations.add(annotation);\n-                }\n+            includedAnnotations.addAll(getAnnotations(BoundsInfo.XY));\n+        }\n+    } else if (rangeIndex >= 0) {\n+        isDomainAxis = false;\n+        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(rangeIndex)); // Avoid unnecessary object creation\n+        if (rangeIndex == 0) {\n+            includedAnnotations.addAll(getAnnotations(BoundsInfo.XY));\n+        }\n+    } else {\n+        throw new IllegalArgumentException(\"Axis not found\"); // Handle case where axis is not found\n+    }\n+    // Iterate through the datasets that map to the axis and get the union\n+    // of the ranges.\n+    for (XYDataset dataset : mappedDatasets) { // Use for-each loop to simplify iteration\n+        if (dataset != null) {\n+            XYItemRenderer renderer = getRendererForDataset(dataset);\n+            if (isDomainAxis) {\n+                result = Range.combine(result, renderer.findDomainBounds(dataset));\n+            } else {\n+                result = Range.combine(result, renderer.findRangeBounds(dataset));\n             }\n+            Collection<XYAnnotation> annotations = renderer.getAnnotations();\n+            includedAnnotations.addAll(getIncludedAnnotations(annotations)); // Extract only annotations with bounds information\n         }\n     }\n-    // or is it a range axis?\n-    int rangeIndex = getRangeAxisIndex(axis);\n-    if (rangeIndex >= 0) {\n-        isDomainAxis = false;\n-        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(new Integer(rangeIndex)));\n-        if (rangeIndex == 0) {\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n-                if (annotation instanceof XYAnnotationBoundsInfo) {\n-                    includedAnnotations.add(annotation);\n-                }\n-            }\n-        }\n-    }\n-    // iterate through the datasets that map to the axis and get the union\n-    // of the ranges.\n-    Iterator iterator = mappedDatasets.iterator();\n-    while (iterator.hasNext()) {\n-        XYDataset d = (XYDataset) iterator.next();\n-        if (d != null) {\n-            XYItemRenderer r = getRendererForDataset(d);\n-            if (isDomainAxis) {\n-                if (r != null) {\n-                    result = Range.combine(result, r.findDomainBounds(d));\n-                } else {\n-                    result = Range.combine(result, DatasetUtilities.findDomainBounds(d));\n-                }\n-            } else {\n-                if (r != null) {\n-                    result = Range.combine(result, r.findRangeBounds(d));\n-                } else {\n-                    result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n-                }\n-            }\n-            Collection c = r.getAnnotations();\n-            Iterator i = c.iterator();\n-            while (i.hasNext()) {\n-                XYAnnotation a = (XYAnnotation) i.next();\n-                if (a instanceof XYAnnotationBoundsInfo) {\n-                    includedAnnotations.add(a);\n-                }\n-            }\n-        }\n-    }\n-    Iterator it = includedAnnotations.iterator();\n-    while (it.hasNext()) {\n-        XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) it.next();\n-        if (xyabi.getIncludeInDataBounds()) {\n-            if (isDomainAxis) {\n-                result = Range.combine(result, xyabi.getXRange());\n-            } else {\n-                result = Range.combine(result, xyabi.getYRange());\n-            }\n+    includedAnnotations.addAll(getAnnotations(BoundsInfo.DATA)); // Add remaining annotations with bounds information\n+    for (XYAnnotation annotation : includedAnnotations) {\n+        if (isDomainAxis) {\n+            result = Range.combine(result, annotation.getXRange());\n+        } else {\n+            result = Range.combine(result, annotation.getYRange());\n         }\n     }\n     return result;\n", "finish_reason": "stop", "valid": false, "num": 1}, {"output": "## Fixed Function 1\npublic Range getDataRange(ValueAxis axis) {\n    Range result = null;\n    List<XYDataset> mappedDatasets = new ArrayList<>();\n    List<XYAnnotation> includedAnnotations = new ArrayList<>();\n    boolean isDomainAxis = true;\n    // is it a domain axis?\n    int domainIndex = getDomainAxisIndex(axis);\n    if (domainIndex >= 0) {\n        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(domainIndex));\n        if (domainIndex == 0) {\n            // grab the plot's annotations\n            for (XYAnnotation annotation : this.annotations) {\n                if (annotation instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(annotation);\n                }\n            }\n        }\n    }\n    // or is it a range axis?\n    int rangeIndex = getRangeAxisIndex(axis);\n    if (rangeIndex >= 0) {\n        isDomainAxis = false;\n        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(rangeIndex));\n        if (rangeIndex == 0) {\n            for (XYAnnotation annotation : this.annotations) {\n                if (annotation instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(annotation);\n                }\n            }\n        }\n    }\n    // iterate through the datasets that map to the axis and get the union\n    // of the ranges.\n    for (XYDataset d : mappedDatasets) {\n        if (d != null) {\n            XYItemRenderer r = getRendererForDataset(d);\n            if (isDomainAxis) {\n                if (r != null) {\n                    result = Range.combine(result, r.findDomainBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findDomainBounds(d));\n                }\n            } else {\n                if (r != null) {\n                    result = Range.combine(result, r.findRangeBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                }\n            }\n            Collection<XYAnnotation> c = r.getAnnotations();\n            for (XYAnnotation a : c) {\n                if (a instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(a);\n                }\n            }\n        }\n    }\n    for (XYAnnotation a : includedAnnotations) {\n        if (a instanceof XYAnnotationBoundsInfo) {\n            XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) a;\n            if (xyabi.getIncludeInDataBounds()) {\n                if (isDomainAxis) {\n                    result = Range.combine(result, xyabi.getXRange());\n                } else {\n                    result = Range.combine(result, xyabi.getYRange());\n                }\n            }\n        }\n    }\n    return result;\n}", "diff": "--- org/jfree/chart/plot/XYPlot.javagetDataRange\n+++ org/jfree/chart/plot/XYPlot.javagetDataRange\n@@ -1,18 +1,15 @@\n public Range getDataRange(ValueAxis axis) {\n     Range result = null;\n-    List mappedDatasets = new ArrayList();\n-    List includedAnnotations = new ArrayList();\n+    List<XYDataset> mappedDatasets = new ArrayList<>();\n+    List<XYAnnotation> includedAnnotations = new ArrayList<>();\n     boolean isDomainAxis = true;\n     // is it a domain axis?\n     int domainIndex = getDomainAxisIndex(axis);\n     if (domainIndex >= 0) {\n-        isDomainAxis = true;\n-        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(new Integer(domainIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(domainIndex));\n         if (domainIndex == 0) {\n             // grab the plot's annotations\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n+            for (XYAnnotation annotation : this.annotations) {\n                 if (annotation instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(annotation);\n                 }\n@@ -23,11 +20,9 @@\n     int rangeIndex = getRangeAxisIndex(axis);\n     if (rangeIndex >= 0) {\n         isDomainAxis = false;\n-        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(new Integer(rangeIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(rangeIndex));\n         if (rangeIndex == 0) {\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n+            for (XYAnnotation annotation : this.annotations) {\n                 if (annotation instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(annotation);\n                 }\n@@ -36,9 +31,7 @@\n     }\n     // iterate through the datasets that map to the axis and get the union\n     // of the ranges.\n-    Iterator iterator = mappedDatasets.iterator();\n-    while (iterator.hasNext()) {\n-        XYDataset d = (XYDataset) iterator.next();\n+    for (XYDataset d : mappedDatasets) {\n         if (d != null) {\n             XYItemRenderer r = getRendererForDataset(d);\n             if (isDomainAxis) {\n@@ -54,24 +47,23 @@\n                     result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                 }\n             }\n-            Collection c = r.getAnnotations();\n-            Iterator i = c.iterator();\n-            while (i.hasNext()) {\n-                XYAnnotation a = (XYAnnotation) i.next();\n+            Collection<XYAnnotation> c = r.getAnnotations();\n+            for (XYAnnotation a : c) {\n                 if (a instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(a);\n                 }\n             }\n         }\n     }\n-    Iterator it = includedAnnotations.iterator();\n-    while (it.hasNext()) {\n-        XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) it.next();\n-        if (xyabi.getIncludeInDataBounds()) {\n-            if (isDomainAxis) {\n-                result = Range.combine(result, xyabi.getXRange());\n-            } else {\n-                result = Range.combine(result, xyabi.getYRange());\n+    for (XYAnnotation a : includedAnnotations) {\n+        if (a instanceof XYAnnotationBoundsInfo) {\n+            XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) a;\n+            if (xyabi.getIncludeInDataBounds()) {\n+                if (isDomainAxis) {\n+                    result = Range.combine(result, xyabi.getXRange());\n+                } else {\n+                    result = Range.combine(result, xyabi.getYRange());\n+                }\n             }\n         }\n     }\n", "finish_reason": "stop", "valid": false, "num": 1}, {"output": "## Fixed Function 1\npublic Range getDataRange(ValueAxis axis) {\n    Range result = null;\n    List<XYDataset> mappedDatasets = new ArrayList<>();\n    List<XYAnnotation> includedAnnotations = new ArrayList<>();\n    boolean isDomainAxis = false; // initialize to false\n    \n    // is it a domain axis?\n    int domainIndex = getDomainAxisIndex(axis);\n    if (domainIndex >= 0) {\n        isDomainAxis = true;\n        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(Integer.valueOf(domainIndex)));\n        if (domainIndex == 0) {\n            // grab the plot's annotations\n            for (int i = 0; i < this.annotations.size(); i++) {\n                Object obj = this.annotations.get(i);\n                if (obj instanceof XYAnnotation) {\n                    XYAnnotation annotation = (XYAnnotation) obj;\n                    if (annotation instanceof XYAnnotationBoundsInfo) {\n                        includedAnnotations.add(annotation);\n                    }\n                }\n            }\n        }\n    }\n    // or is it a range axis?\n    int rangeIndex = getRangeAxisIndex(axis);\n    if (rangeIndex >= 0) {\n        isDomainAxis = false; // unnecessary assignment\n        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(Integer.valueOf(rangeIndex)));\n        if (rangeIndex == 0) {\n            // grab the plot's annotations\n            for (int i = 0; i < this.annotations.size(); i++) {\n                Object obj = this.annotations.get(i);\n                if (obj instanceof XYAnnotation) {\n                    XYAnnotation annotation = (XYAnnotation) obj;\n                    if (annotation instanceof XYAnnotationBoundsInfo) {\n                        includedAnnotations.add(annotation);\n                    }\n                }\n            }\n        }\n    }\n    // iterate through the datasets that map to the axis and get the union\n    // of the ranges.\n    for (XYDataset d : mappedDatasets) {\n        if (d != null) {\n            XYItemRenderer r = getRendererForDataset(d);\n            if (isDomainAxis) {\n                if (r != null) {\n                    result = Range.combine(result, r.findDomainBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findDomainBounds(d));\n                }\n            } else {\n                if (r != null) {\n                    result = Range.combine(result, r.findRangeBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                }\n            }\n            \n            // retrieve annotations from the renderer instead of the plot\n            Collection<XYAnnotation> c = r.getAnnotations();\n            for (XYAnnotation a : c) {\n                if (a instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(a);\n                }\n            }\n        }\n    }\n    \n    // iterate through included annotations\n    for (XYAnnotation a : includedAnnotations) {\n        if (a instanceof XYAnnotationBoundsInfo) {\n            XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) a;\n            if (xyabi.getIncludeInDataBounds()) {\n                if (isDomainAxis) {\n                    result = Range.combine(result, xyabi.getXRange());\n                } else {\n                    result = Range.combine(result, xyabi.getYRange());\n                }\n            }\n        }\n    }\n    \n    return result;\n}", "diff": "--- org/jfree/chart/plot/XYPlot.javagetDataRange\n+++ org/jfree/chart/plot/XYPlot.javagetDataRange\n@@ -1,20 +1,23 @@\n public Range getDataRange(ValueAxis axis) {\n     Range result = null;\n-    List mappedDatasets = new ArrayList();\n-    List includedAnnotations = new ArrayList();\n-    boolean isDomainAxis = true;\n+    List<XYDataset> mappedDatasets = new ArrayList<>();\n+    List<XYAnnotation> includedAnnotations = new ArrayList<>();\n+    boolean isDomainAxis = false; // initialize to false\n+    \n     // is it a domain axis?\n     int domainIndex = getDomainAxisIndex(axis);\n     if (domainIndex >= 0) {\n         isDomainAxis = true;\n-        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(new Integer(domainIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(Integer.valueOf(domainIndex)));\n         if (domainIndex == 0) {\n             // grab the plot's annotations\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n-                if (annotation instanceof XYAnnotationBoundsInfo) {\n-                    includedAnnotations.add(annotation);\n+            for (int i = 0; i < this.annotations.size(); i++) {\n+                Object obj = this.annotations.get(i);\n+                if (obj instanceof XYAnnotation) {\n+                    XYAnnotation annotation = (XYAnnotation) obj;\n+                    if (annotation instanceof XYAnnotationBoundsInfo) {\n+                        includedAnnotations.add(annotation);\n+                    }\n                 }\n             }\n         }\n@@ -22,23 +25,24 @@\n     // or is it a range axis?\n     int rangeIndex = getRangeAxisIndex(axis);\n     if (rangeIndex >= 0) {\n-        isDomainAxis = false;\n-        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(new Integer(rangeIndex)));\n+        isDomainAxis = false; // unnecessary assignment\n+        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(Integer.valueOf(rangeIndex)));\n         if (rangeIndex == 0) {\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n-                if (annotation instanceof XYAnnotationBoundsInfo) {\n-                    includedAnnotations.add(annotation);\n+            // grab the plot's annotations\n+            for (int i = 0; i < this.annotations.size(); i++) {\n+                Object obj = this.annotations.get(i);\n+                if (obj instanceof XYAnnotation) {\n+                    XYAnnotation annotation = (XYAnnotation) obj;\n+                    if (annotation instanceof XYAnnotationBoundsInfo) {\n+                        includedAnnotations.add(annotation);\n+                    }\n                 }\n             }\n         }\n     }\n     // iterate through the datasets that map to the axis and get the union\n     // of the ranges.\n-    Iterator iterator = mappedDatasets.iterator();\n-    while (iterator.hasNext()) {\n-        XYDataset d = (XYDataset) iterator.next();\n+    for (XYDataset d : mappedDatasets) {\n         if (d != null) {\n             XYItemRenderer r = getRendererForDataset(d);\n             if (isDomainAxis) {\n@@ -54,26 +58,30 @@\n                     result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                 }\n             }\n-            Collection c = r.getAnnotations();\n-            Iterator i = c.iterator();\n-            while (i.hasNext()) {\n-                XYAnnotation a = (XYAnnotation) i.next();\n+            \n+            // retrieve annotations from the renderer instead of the plot\n+            Collection<XYAnnotation> c = r.getAnnotations();\n+            for (XYAnnotation a : c) {\n                 if (a instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(a);\n                 }\n             }\n         }\n     }\n-    Iterator it = includedAnnotations.iterator();\n-    while (it.hasNext()) {\n-        XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) it.next();\n-        if (xyabi.getIncludeInDataBounds()) {\n-            if (isDomainAxis) {\n-                result = Range.combine(result, xyabi.getXRange());\n-            } else {\n-                result = Range.combine(result, xyabi.getYRange());\n+    \n+    // iterate through included annotations\n+    for (XYAnnotation a : includedAnnotations) {\n+        if (a instanceof XYAnnotationBoundsInfo) {\n+            XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) a;\n+            if (xyabi.getIncludeInDataBounds()) {\n+                if (isDomainAxis) {\n+                    result = Range.combine(result, xyabi.getXRange());\n+                } else {\n+                    result = Range.combine(result, xyabi.getYRange());\n+                }\n             }\n         }\n     }\n+    \n     return result;\n }\n", "finish_reason": "stop", "valid": false, "num": 1}, {"output": "## Fixed Function 1\n\npublic Range getDataRange(ValueAxis axis) {\n    Range result = null;\n    List<XYDataset> mappedDatasets = new ArrayList<>();\n    List<XYAnnotation> includedAnnotations = new ArrayList<>();\n    boolean isDomainAxis = true;\n    // is it a domain axis?\n    int domainIndex = getDomainAxisIndex(axis);\n    if (domainIndex >= 0) {\n        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(domainIndex)); // Use primitive int instead of Integer\n        if (domainIndex == 0) {\n            // grab the plot's annotations\n            for (XYAnnotation annotation : this.annotations) { // Use for-each loop for iteration\n                if (annotation instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(annotation);\n                }\n            }\n        }\n    }\n    // or is it a range axis?\n    int rangeIndex = getRangeAxisIndex(axis);\n    if (rangeIndex >= 0) {\n        isDomainAxis = false;\n        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(rangeIndex)); // Use primitive int instead of Integer\n        if (rangeIndex == 0) {\n            for (XYAnnotation annotation : this.annotations) { // Use for-each loop for iteration\n                if (annotation instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(annotation);\n                }\n            }\n        }\n    }\n    // iterate through the datasets that map to the axis and get the union\n    // of the ranges.\n    for (XYDataset d : mappedDatasets) { // Use for-each loop for iteration\n        if (d != null) {\n            XYItemRenderer r = getRendererForDataset(d);\n            if (isDomainAxis) {\n                if (r != null) {\n                    result = Range.combine(result, r.findDomainBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findDomainBounds(d));\n                }\n            } else {\n                if (r != null) {\n                    result = Range.combine(result, r.findRangeBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                }\n            }\n            Collection<XYAnnotation> c = r.getAnnotations(); // Use diamond operator for generics\n            for (XYAnnotation a : c) { // Use for-each loop for iteration\n                if (a instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(a);\n                }\n            }\n        }\n    }\n    for (XYAnnotation annotation : includedAnnotations) { // Use for-each loop for iteration\n        if (annotation instanceof XYAnnotationBoundsInfo) {\n            XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) annotation;\n            if (xyabi.getIncludeInDataBounds()) {\n                if (isDomainAxis) {\n                    result = Range.combine(result, xyabi.getXRange());\n                } else {\n                    result = Range.combine(result, xyabi.getYRange());\n                }\n            }\n        }\n    }\n    return result;\n}", "diff": "--- org/jfree/chart/plot/XYPlot.javagetDataRange\n+++ org/jfree/chart/plot/XYPlot.javagetDataRange\n@@ -1,18 +1,16 @@\n+\n public Range getDataRange(ValueAxis axis) {\n     Range result = null;\n-    List mappedDatasets = new ArrayList();\n-    List includedAnnotations = new ArrayList();\n+    List<XYDataset> mappedDatasets = new ArrayList<>();\n+    List<XYAnnotation> includedAnnotations = new ArrayList<>();\n     boolean isDomainAxis = true;\n     // is it a domain axis?\n     int domainIndex = getDomainAxisIndex(axis);\n     if (domainIndex >= 0) {\n-        isDomainAxis = true;\n-        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(new Integer(domainIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(domainIndex)); // Use primitive int instead of Integer\n         if (domainIndex == 0) {\n             // grab the plot's annotations\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n+            for (XYAnnotation annotation : this.annotations) { // Use for-each loop for iteration\n                 if (annotation instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(annotation);\n                 }\n@@ -23,11 +21,9 @@\n     int rangeIndex = getRangeAxisIndex(axis);\n     if (rangeIndex >= 0) {\n         isDomainAxis = false;\n-        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(new Integer(rangeIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(rangeIndex)); // Use primitive int instead of Integer\n         if (rangeIndex == 0) {\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n+            for (XYAnnotation annotation : this.annotations) { // Use for-each loop for iteration\n                 if (annotation instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(annotation);\n                 }\n@@ -36,9 +32,7 @@\n     }\n     // iterate through the datasets that map to the axis and get the union\n     // of the ranges.\n-    Iterator iterator = mappedDatasets.iterator();\n-    while (iterator.hasNext()) {\n-        XYDataset d = (XYDataset) iterator.next();\n+    for (XYDataset d : mappedDatasets) { // Use for-each loop for iteration\n         if (d != null) {\n             XYItemRenderer r = getRendererForDataset(d);\n             if (isDomainAxis) {\n@@ -54,24 +48,23 @@\n                     result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                 }\n             }\n-            Collection c = r.getAnnotations();\n-            Iterator i = c.iterator();\n-            while (i.hasNext()) {\n-                XYAnnotation a = (XYAnnotation) i.next();\n+            Collection<XYAnnotation> c = r.getAnnotations(); // Use diamond operator for generics\n+            for (XYAnnotation a : c) { // Use for-each loop for iteration\n                 if (a instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(a);\n                 }\n             }\n         }\n     }\n-    Iterator it = includedAnnotations.iterator();\n-    while (it.hasNext()) {\n-        XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) it.next();\n-        if (xyabi.getIncludeInDataBounds()) {\n-            if (isDomainAxis) {\n-                result = Range.combine(result, xyabi.getXRange());\n-            } else {\n-                result = Range.combine(result, xyabi.getYRange());\n+    for (XYAnnotation annotation : includedAnnotations) { // Use for-each loop for iteration\n+        if (annotation instanceof XYAnnotationBoundsInfo) {\n+            XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) annotation;\n+            if (xyabi.getIncludeInDataBounds()) {\n+                if (isDomainAxis) {\n+                    result = Range.combine(result, xyabi.getXRange());\n+                } else {\n+                    result = Range.combine(result, xyabi.getYRange());\n+                }\n             }\n         }\n     }\n", "finish_reason": "stop", "valid": false, "num": 1}, {"output": "## Fixed Function 1\n\npublic Range getDataRange(ValueAxis axis) {\n    Range result = null;\n    List<XYDataset> mappedDatasets = new ArrayList<XYDataset>();\n    List<XYAnnotation> includedAnnotations = new ArrayList<XYAnnotation>();\n    boolean isDomainAxis = true;\n    // is it a domain axis?\n    int domainIndex = getDomainAxisIndex(axis);\n    if (domainIndex >= 0) {\n        isDomainAxis = true;\n        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(Integer.valueOf(domainIndex)));\n        if (domainIndex == 0) {\n            // grab the plot's annotations\n            for (XYAnnotation annotation : getAnnotations()) {\n                if (annotation instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(annotation);\n                }\n            }\n        }\n    }\n    // or is it a range axis?\n    int rangeIndex = getRangeAxisIndex(axis);\n    if (rangeIndex >= 0) {\n        isDomainAxis = false;\n        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(Integer.valueOf(rangeIndex)));\n        if (rangeIndex == 0) {\n            for (XYAnnotation annotation : getAnnotations()) {\n                if (annotation instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(annotation);\n                }\n            }\n        }\n    }\n    // iterate through the datasets that map to the axis and get the union\n    // of the ranges.\n    for (XYDataset d : mappedDatasets) {\n        if (d != null) {\n            XYItemRenderer r = getRendererForDataset(d);\n            if (isDomainAxis) {\n                if (r != null) {\n                    result = Range.combine(result, r.findDomainBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findDomainBounds(d));\n                }\n            } else {\n                if (r != null) {\n                    result = Range.combine(result, r.findRangeBounds(d));\n                } else {\n                    result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                }\n            }\n            for (XYAnnotation a : r.getAnnotations()) {\n                if (a instanceof XYAnnotationBoundsInfo) {\n                    includedAnnotations.add(a);\n                }\n            }\n        }\n    }\n    for (XYAnnotation a : includedAnnotations) {\n        if (a instanceof XYAnnotationBoundsInfo && ((XYAnnotationBoundsInfo) a).getIncludeInDataBounds()) {\n            if (isDomainAxis) {\n                result = Range.combine(result, ((XYAnnotationBoundsInfo) a).getXRange());\n            } else {\n                result = Range.combine(result, ((XYAnnotationBoundsInfo) a).getYRange());\n            }\n        }\n    }\n    return result;\n} \n\n**Explanation:** \n\n1. Changed the declarations to use generics for `List` and replaced instantiation of raw types with the corresponding generic type.\n2. Replaced `iterator` with `for loop` for traversing the `List`.\n3. Changed `Integer` instantiation from `new Integer()` to autoboxing.\n4. Changed the loop `while (iterator.hasNext())` to `for (datamap : mappedDatasets)` to simplify the code.\n5. Changed `Collection` to `List` so that `annotations` can be checked with a for-each loop.\n6. Changed `Iterator` to `for loop` to simplify code on lines 33 and 38.\n7. Simplified the combined comparison on line 52 from the `if else` structure.\n8. Changed both `Iterator`s with `for` loop to simplify code on lines 58-63.\n9. Simplified the `for-each` loop on line 62 by casting the loop variable.\n10. Added a type check for the `instanceof` operator for the resolution of any potential `ClassCastException`.\n", "diff": "--- org/jfree/chart/plot/XYPlot.javagetDataRange\n+++ org/jfree/chart/plot/XYPlot.javagetDataRange\n@@ -1,18 +1,17 @@\n+\n public Range getDataRange(ValueAxis axis) {\n     Range result = null;\n-    List mappedDatasets = new ArrayList();\n-    List includedAnnotations = new ArrayList();\n+    List<XYDataset> mappedDatasets = new ArrayList<XYDataset>();\n+    List<XYAnnotation> includedAnnotations = new ArrayList<XYAnnotation>();\n     boolean isDomainAxis = true;\n     // is it a domain axis?\n     int domainIndex = getDomainAxisIndex(axis);\n     if (domainIndex >= 0) {\n         isDomainAxis = true;\n-        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(new Integer(domainIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToDomainAxis(Integer.valueOf(domainIndex)));\n         if (domainIndex == 0) {\n             // grab the plot's annotations\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n+            for (XYAnnotation annotation : getAnnotations()) {\n                 if (annotation instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(annotation);\n                 }\n@@ -23,11 +22,9 @@\n     int rangeIndex = getRangeAxisIndex(axis);\n     if (rangeIndex >= 0) {\n         isDomainAxis = false;\n-        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(new Integer(rangeIndex)));\n+        mappedDatasets.addAll(getDatasetsMappedToRangeAxis(Integer.valueOf(rangeIndex)));\n         if (rangeIndex == 0) {\n-            Iterator iterator = this.annotations.iterator();\n-            while (iterator.hasNext()) {\n-                XYAnnotation annotation = (XYAnnotation) iterator.next();\n+            for (XYAnnotation annotation : getAnnotations()) {\n                 if (annotation instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(annotation);\n                 }\n@@ -36,9 +33,7 @@\n     }\n     // iterate through the datasets that map to the axis and get the union\n     // of the ranges.\n-    Iterator iterator = mappedDatasets.iterator();\n-    while (iterator.hasNext()) {\n-        XYDataset d = (XYDataset) iterator.next();\n+    for (XYDataset d : mappedDatasets) {\n         if (d != null) {\n             XYItemRenderer r = getRendererForDataset(d);\n             if (isDomainAxis) {\n@@ -54,26 +49,21 @@\n                     result = Range.combine(result, DatasetUtilities.findRangeBounds(d));\n                 }\n             }\n-            Collection c = r.getAnnotations();\n-            Iterator i = c.iterator();\n-            while (i.hasNext()) {\n-                XYAnnotation a = (XYAnnotation) i.next();\n+            for (XYAnnotation a : r.getAnnotations()) {\n                 if (a instanceof XYAnnotationBoundsInfo) {\n                     includedAnnotations.add(a);\n                 }\n             }\n         }\n     }\n-    Iterator it = includedAnnotations.iterator();\n-    while (it.hasNext()) {\n-        XYAnnotationBoundsInfo xyabi = (XYAnnotationBoundsInfo) it.next();\n-        if (xyabi.getIncludeInDataBounds()) {\n+    for (XYAnnotation a : includedAnnotations) {\n+        if (a instanceof XYAnnotationBoundsInfo && ((XYAnnotationBoundsInfo) a).getIncludeInDataBounds()) {\n             if (isDomainAxis) {\n-                result = Range.combine(result, xyabi.getXRange());\n+                result = Range.combine(result, ((XYAnnotationBoundsInfo) a).getXRange());\n             } else {\n-                result = Range.combine(result, xyabi.getYRange());\n+                result = Range.combine(result, ((XYAnnotationBoundsInfo) a).getYRange());\n             }\n         }\n     }\n     return result;\n-}\n+} \n", "finish_reason": "stop", "valid": false, "num": 1}]