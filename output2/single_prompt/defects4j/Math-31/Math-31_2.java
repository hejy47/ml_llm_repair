The code seems to be fine. It is difficult to identify the bug without a clear understanding of the purpose of the function and what it is supposed to achieve.